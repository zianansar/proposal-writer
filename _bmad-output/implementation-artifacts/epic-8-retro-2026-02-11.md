# Epic 8 Retrospective - February 11, 2026

**Project:** Upwork Research Agent
**Epic:** Epic 8 - Essential UX & Accessibility
**Retrospective Date:** 2026-02-11
**Facilitator:** Bob (Scrum Master)
**Participants:** Zian (Project Lead), Alice (Product Owner), Charlie (Senior Dev), Dana (QA Engineer), Elena (Junior Dev)

---

## Executive Summary

Epic 8 delivered **11/11 stories completed** (100%), establishing comprehensive UX and accessibility infrastructure including a design token system, WCAG AA compliance tooling, keyboard navigation, screen reader support, E2E test scaffolding, performance bench framework, network security enforcement, and zero-telemetry verification.

**Key Metrics:**
- **Stories Completed:** 11/11 (100%) — 8th consecutive epic at 100%
- **Code Review Rounds:** 11+ (every story reviewed, most had 2 rounds)
- **Issues Found & Fixed:** ~100+ total across all stories
- **Security Fix:** 1 — validate_url() HTTPS enforcement gap (Story 8-13)
- **Design Tokens Created:** 103 CSS custom properties (Story 8-1)
- **Accessibility Tests Added:** 39 axe-core tests (Story 8-11)
- **Production Incidents:** 0
- **New Technical Debt:** E2E stubs (8-9), perf bench stubs (8-10), manual screen reader testing unverified (8-11)

**Key Achievement:** NFR-20 (WCAG AA) infrastructure, NFR-8 (zero telemetry) verification, AR-14 (network allowlist) enforcement, comprehensive design token system, and accessibility primitives (LiveAnnouncer, focus traps, skip links, ARIA landmarks).

---

## What Went Well (Successes)

### 1. Design Token System (Story 8-1)

**Evidence:** 103 CSS custom properties covering colors, spacing, typography, borders, shadows, and component-specific tokens. Dark/light theme switching via `[data-theme]` attribute.

**Impact:**
- Foundation for consistent theming across all components
- Dark mode support without per-component CSS overrides
- Code review caught 30+ hardcoded hex colors in initial implementation — tokens provide the right pattern

**Lesson:** A design token system is only as good as its enforcement. Tokens need lint rules or CI checks to prevent hardcoded color regression.

### 2. Dual-Layer Network Security (Story 8-13)

**Evidence:** CSP `connect-src` in Tauri config restricts frontend requests. Rust-side `validate_url()` enforces domain allowlist AND HTTPS. `analyze_perplexity()` emits blocked-request events for monitoring.

**Impact:**
- Defense in depth — even if CSP is bypassed, Rust validation catches unauthorized requests
- HTTPS enforcement prevents MITM attacks (caught in code review — initial implementation allowed HTTP)
- BlockedRequestsState capped at 100 entries to prevent unbounded memory growth

**Lesson:** Network security needs both browser-level (CSP) and application-level (Rust) enforcement. Code review caught the HTTPS gap that could have been a real vulnerability.

### 3. Accessibility Infrastructure (Stories 8-2, 8-3, 8-11)

**Evidence:**
- `useFocusTrap` hook applied to 6 modals (8-2)
- `SkipLink` component for keyboard users (8-2)
- `useArrowKeyNavigation` hook for list navigation (8-2)
- `LiveAnnouncer` provider/hook for screen reader announcements (8-3)
- Semantic landmarks, heading hierarchy, ARIA labels (8-3)
- axe-core integration with 39 automated WCAG AA tests (8-11)

**Impact:**
- WCAG AA compliance is now testable, not aspirational
- Accessibility primitives are reusable across all future components
- 43 keyboard nav tests + 20 screen reader tests + 39 axe-core tests = comprehensive coverage

**Lesson:** Accessibility infrastructure (hooks, providers, test utilities) pays for itself many times over. Building it once means every future component gets accessibility for free.

### 4. Shared Virtualization Utilities (Story 8-7)

**Evidence:** `VirtualizedList` component wrapping react-window, `useInfiniteScroll` hook, paginated Rust query (`get_proposals_paginated`). Shared utilities in `src/lib/virtualization/`.

**Impact:**
- Large proposal lists render efficiently (only visible items in DOM)
- Paginated backend queries prevent loading all data at once
- Pattern is reusable for any list in the app (jobs, revisions, history)

**Lesson:** Virtualization + pagination is the correct pattern for any list that could grow unbounded. Building shared utilities prevents each feature from reinventing the wheel.

### 5. E2E Test Scaffolding (Story 8-9)

**Evidence:** Playwright config, 7 page objects (AppPage, JobInputPage, ProposalPage, SettingsPage, HistoryPage, VoicePage, OnboardingPage), 4 journey specs, accessibility specs, two-layer API mocking (MSW + Playwright route).

**Impact:**
- Page object model enables maintainable E2E tests
- Journey specs cover critical user flows (first-time user, returning user, golden set calibration, safety override)
- Infrastructure is ready — just needs `tauri-driver` integration to actually run

**Lesson:** E2E test infrastructure is valuable even before tests run. Page objects and journey specs document expected behavior and will accelerate testing once the Tauri driver integration is resolved.

### 6. Consistent Delivery

**Evidence:** 8th consecutive epic at 100% completion. All 11 stories delivered with code review.

**Impact:** Predictable delivery builds confidence in planning and estimation.

---

## What Didn't Go Well (Challenges)

### 1. LiveAnnouncer Cross-Story Test Regressions

**Evidence:** Story 8-3 added `LiveAnnouncerProvider` to the component tree. Existing tests for CopyButton, ProposalOutput, VoiceSettings, and App components broke because they weren't wrapped in the provider.

**Impact:**
- Multiple stories spent time debugging test failures unrelated to their scope
- Story 8-6 specifically documented LiveAnnouncer regressions in VoiceSettings and CopyButton tests
- No shared `renderWithProviders` utility existed to centralize provider wrapping

**Root Cause:** No migration protocol for cross-cutting React context providers. Adding a new provider to the tree has test implications that aren't systematically addressed.

**Resolution Needed:** Create `renderWithProviders()` utility that wraps all required providers. Embed as AC in Story 2-7b.

### 2. AC Violations Claimed as Complete

**Evidence:**
- Story 8-10: Tasks 2, 4, 5 marked [x] but were `.skip()` stubs. Claimed "8 functional benchmarks" — actual count was 0.
- Story 8-11: Manual screen reader testing documented as complete but never actually executed.
- Story 8-1: 30+ hardcoded hex colors remained after "token migration" was marked complete.

**Impact:**
- False confidence in story completion
- Code review is the only mechanism catching these violations
- 5th consecutive epic with this pattern (flagged since Epic 4b)

**Root Cause:** AC verification is perfunctory — checkboxes are marked without end-to-end verification. The "prove it" step from Epic 6's retro was never implemented.

**Resolution Needed:** This is a systemic issue. No retro action item has fixed it in 5 epics. The only viable approach is embedding verification as explicit story ACs (e.g., "AC-X: Run `vitest --reporter=verbose` and paste output in story file").

### 3. E2E Testing Blocked by Tauri Runtime

**Evidence:** Story 8-9 assumed `@tauri-apps/webdriver` package existed — it doesn't. Alternative (`tauri-driver` with WebDriver protocol at port 4444) is significantly more complex. E2E specs are scaffolding only — they won't run until driver integration is built.

**Impact:**
- Story 8-9's E2E tests are infrastructure without execution
- User journey validation (first-time user, returning user) remains untested end-to-end
- Tauri desktop apps have fundamentally different testability than web apps

**Root Cause:** Tauri 2.x E2E testing ecosystem is immature. The planning assumption that a standard WebDriver package would be available was incorrect.

**Resolution Needed:** Decide before release: (a) invest in `tauri-driver` integration, (b) accept unit+integration tests only, or (c) manual E2E testing protocol.

### 4. Performance Benchmarks Blocked by Tauri Runtime

**Evidence:** Story 8-10's bench files call `invoke()` which requires Tauri runtime — unavailable in Vitest/Node. Tasks 2, 4, 5 are `.skip()` stubs. Baseline.json was cleared because values were fabricated.

**Impact:**
- NFR validation (startup time, generation speed, memory usage) is not automated
- Performance regression detection is not possible with current infrastructure
- Story claimed completion despite 0 functional benchmarks

**Root Cause:** Same as E2E — Tauri runtime is not available in Node test environments. Pure Rust benchmarks would work but weren't implemented.

**Resolution Needed:** Either (a) extract performance-critical paths as pure Rust benchmarks, or (b) create Tauri integration test harness, or (c) accept manual performance validation.

### 5. Design Tokens Not Enforced

**Evidence:** Story 8-1 established 103 design tokens. Story 8-14 immediately used hardcoded hex colors (`#5cb85c`, `#f59e0b`) that code review had to catch. Fixed to use `var(--color-success)` / `var(--color-warning)`.

**Impact:**
- Design token system is a suggestion, not a standard
- Every future story risks introducing hardcoded colors
- Code review bandwidth wasted on preventable issues

**Root Cause:** No automated enforcement (lint rule, CI check) for design token usage.

**Resolution Needed:** Add stylelint rule or CI check that flags hardcoded color values in CSS files.

### 6. Story 2-7b: 7 Epics Deferred — RELEASE BLOCKER

**Evidence:** Flagged as RELEASE BLOCKER since Epic 5 retro. Status unchanged: `backlog`. Users cannot unlock encrypted database on app restart without this story.

**Impact:**
- Core functionality gap — encryption is useless if users can't unlock
- Credibility of retrospective process continues to erode
- 4 consecutive retros have escalated this with zero effect

**Root Cause:** Retrospective escalation is not a scheduling mechanism. The story was never prioritized in sprint planning because it's in Epic 2 (already "done") and new epic stories took priority.

**Resolution Needed:** Direct scheduling as #1 priority before any post-MVP work.

---

## Key Insights & Lessons Learned

### 1. Cross-Cutting Infrastructure Changes Need Migration Protocols

**Insight:** When you add a new React context provider (like LiveAnnouncer), every test that renders components needs updating. Without a protocol, this creates landmines for subsequent stories.

**Evidence:** LiveAnnouncer regressions appeared in Stories 8-6 and affected CopyButton, ProposalOutput, VoiceSettings, and App tests.

**Application:** Rule: Any PR adding a new React context provider MUST also update the shared test render utility and fix all affected tests in the same PR.

### 2. Retro Action Items Have a 0% Follow-Through Rate — The System Is Broken

**Insight:** Across 4 consecutive retrospectives (Epics 4b through 8), follow-through rates were: 17% → 17% → 10% → 0%. Standalone action items do not get executed. The meta-agreement from Epic 6 ("embed improvements in story ACs") was itself not followed.

**Evidence:** The "prove it" AC verification step was agreed to in Epic 6's retro. It was violated in Epic 8's Stories 8-10 and 8-11. The meta-agreement about embedding improvements was not embedded in any Epic 8 story's acceptance criteria.

**Application:** Stop writing traditional retro action items entirely. Every improvement must be encoded as: (a) a story AC, (b) a CI check, or (c) a code review checklist item that's machine-enforceable. If it can't be encoded as one of these three things, it won't happen.

### 3. Tauri Desktop Apps Have Fundamentally Different Testability

**Insight:** Web app testing patterns (Playwright + browser, Vitest + jsdom) don't fully work for Tauri apps. Tauri IPC (`invoke()`) requires the Rust runtime. E2E testing requires `tauri-driver`, not standard WebDriver packages.

**Evidence:** Stories 8-9 and 8-10 both hit this wall. E2E specs are scaffolding. Performance benchmarks are skipped.

**Application:** For Tauri projects, test strategy must explicitly account for three layers: (1) pure Rust unit tests (no Tauri runtime needed), (2) frontend unit tests with mocked `invoke()`, (3) integration/E2E tests requiring `tauri-driver`. Layer 3 is significantly more complex than web E2E.

### 4. Design Systems Without Enforcement Are Suggestions

**Insight:** Creating 103 CSS design tokens is valuable, but without lint rules or CI enforcement, hardcoded values creep back in immediately.

**Evidence:** Story 8-14 used hardcoded colors in the same epic that established the token system.

**Application:** Design token systems need a companion lint rule from day one. The rule should flag any hex color literal in CSS that could use a token instead.

### 5. Code Review Is Doing Heavy Lifting (And That's Both Good and Concerning)

**Insight:** 100% of Epic 8 stories had code review findings, including a security gap (HTTPS enforcement in 8-13). Code review caught AC violations, hardcoded colors, missing tests, frontmatter errors, and security issues.

**Evidence:** Every story had at least one round of review. Most had two. Issues ranged from LOW (documentation) to CRITICAL (security).

**Application:** Code review is working — don't weaken it. But add upstream gates (lint rules, AC verification scripts, shared test utilities) to reduce the burden on reviewers.

---

## Technical Debt Identified

### CRITICAL Priority (MVP Blocker, Carried)

1. **Story 2-7b: Encrypted Database Access Frontend** (carried from Epic 2 — **7 epics old**)
   - **Issue:** Frontend passphrase unlock not implemented
   - **Impact:** Users can't unlock encrypted database on app restart
   - **Status:** RELEASE BLOCKER — escalated in Epic 5 retro, repeated in Epics 6, 8

### HIGH Priority

2. **Story 0-5: Validate AI Detection Passing** (Epic 0 — still in-progress, **8+ epics old**)
   - **Issue:** Core product promise (AI detection avoidance) unverified
   - **Impact:** Product may not deliver its primary value proposition

3. **E2E Test Stubs** (new from Epic 8)
   - **Issue:** Story 8-9 E2E specs are scaffolding only — no `tauri-driver` integration
   - **Impact:** User journeys not tested end-to-end

4. **Performance Benchmark Stubs** (new from Epic 8)
   - **Issue:** Story 8-10 bench files are mocked/skipped — 0 functional benchmarks
   - **Impact:** NFR validation (startup, generation speed, memory) not automated

### MEDIUM Priority (Carried)

5. **API Mocking Infrastructure** (carried from Epic 4a — 5 epics old)
6. **SettingsPanel Test Harness** (carried from Epic 4b — 4 epics old)
7. **voice.rs Modularization** (carried from Epic 5)
8. **Duplicate Quick Calibration Mapping** (carried from Epic 5)

### LOW Priority (Carried)

9. **Windows Rust build environment** (carried from Epic 4a — 5 epics old)
10. **Syllable counting / bullet patterns / technical terms** (carried from Epic 5)

**New Debt from Epic 8:** 2 items (E2E stubs, perf bench stubs)
**Carried from Previous Epics:** 8+ items
**Grand Total Outstanding:** ~12 items

---

## Previous Epic 6 Retro Follow-Through

| # | Commitment | Status | Evidence |
|---|-----------|--------|----------|
| 1 | AC verification as "prove it" step | ❌ Not Done | 8-10 had .skip() stubs marked complete. 8-11 manual testing marked done but unexecuted |
| 2 | DOMPurify required for HTML rendering | ✅ N/A | No HTML rendering in Epic 8 |
| 3 | Stop standalone action items — embed in ACs | ⏳ Partial | Not consistently embedded in Epic 8 stories |

**Team Agreements Follow-Through:**

| Agreement | Status | Evidence |
|-----------|--------|----------|
| AC verification requires "prove it" | ❌ Not Done | 8-10 stubs, 8-11 unverified |
| DOMPurify for HTML rendering | ✅ N/A | Not applicable |
| Archive pattern for historical data | ✅ N/A | Not applicable |
| Content swapping over remounting | ✅ N/A | Not applicable |
| Property getters for platform constants | ✅ Applied | 8-2 keyboard shortcuts |
| META: Embed improvements in story ACs | ⏳ Partial | Not consistently applied |

**Follow-Through Rate:** 0/1 applicable items completed (0%)

**Key Observation:** Follow-through rate across 4 retros: 17% → 17% → 10% → 0%. The retrospective action item mechanism is demonstrably broken. This retro adopts a new approach: no standalone action items. All improvements encoded as story ACs, CI checks, or machine-enforceable review checklist items.

---

## Embedded Improvements (Replaces Traditional Action Items)

### Story 2-7b AC Additions

1. **AC-NEW-1: Shared test render utility**
   - Create `renderWithProviders()` wrapping LiveAnnouncerProvider + all required contexts
   - All existing component tests migrated to use shared utility
   - Success: `grep -r "render(" src/ --include="*.test.*" | grep -v renderWithProviders` returns 0 results

2. **AC-NEW-2: Design token lint check**
   - Add stylelint rule or grep-based CI check flagging hardcoded hex colors in CSS
   - Success: CI fails on any PR introducing hardcoded color values outside of `tokens.css`

### Pre-Release Gates

3. **Gate 1: Story 2-7b completion**
   - RELEASE BLOCKER — users cannot unlock encrypted database without this
   - Must reach `done` before any post-MVP work

4. **Gate 2: Story 0-5 completion**
   - Core product promise — AI detection avoidance must be validated
   - Must reach `done` before any post-MVP work

5. **Gate 3: E2E/Perf test decision**
   - Decide: real `tauri-driver` integration, manual testing protocol, or accept stubs
   - Decision must be documented before release

### Code Review Checklist Additions

6. **Check: Hardcoded hex colors** — flag any CSS color literal not using `var(--token-name)`
7. **Check: AC verification** — reviewer verifies each AC has a cited test name or demonstration
8. **Check: New provider = migration** — any new React context provider must include test utility updates

### Team Agreements

- No raw `render()` in tests — always use `renderWithProviders()`
- New provider = migration PR (provider + test utility update in same PR)
- No more retro action items section — improvements embedded as ACs, CI checks, or review checklist items
- Story completion requires pasting actual `vitest --reporter=verbose` output in dev notes

---

## Readiness Assessment

| Dimension | Status | Notes |
|-----------|--------|-------|
| Testing & Quality | ⚠️ Partial | Unit tests strong (~500+), E2E scaffolding only, perf benches skipped |
| Deployment | ⏳ Pre-release | Desktop app not yet deployed; Epic 9 (Deployment) is post-MVP |
| Stakeholder Acceptance | ✅ N/A | Solo project |
| Technical Health | ✅ Healthy | Design tokens, accessibility infra, network security, zero telemetry |
| Unresolved Blockers | ⚠️ 2 items | Story 2-7b (RELEASE BLOCKER), Story 0-5 (in-progress) |

**Overall:** Epic 8 stories are complete. MVP feature set is delivered. Release readiness depends on completing Stories 0-5 and 2-7b, plus a decision on E2E/perf test strategy.

---

## Retrospective Commitments Summary

- **Stories Completed:** 11/11 (100%) — 8th consecutive 100% epic
- **Technical Debt:** 2 new items (E2E stubs, perf bench stubs) + ~10 carried = ~12 total
- **Test Coverage:** ~500+ tests across frontend and backend, HIGH confidence for unit/integration
- **Previous Retro Follow-Through:** 0/1 applicable (0%) — confirms broken mechanism
- **Meta-Insight:** Retro action items have failed across 4 consecutive epics (17% → 17% → 10% → 0%). This retro adopts embedded improvements (ACs, CI checks, review checklists) as the replacement.

### Next Steps

1. **Complete Story 2-7b** (encrypted DB frontend) — RELEASE BLOCKER, #1 priority
2. **Complete Story 0-5** (AI detection validation) — core product promise
3. **Decide E2E/perf test strategy** — real integration vs manual vs accept stubs
4. **Post-MVP planning** for Epics 7, 9, 10 (only after gates 1-3 cleared)

---

## Team Acknowledgments

Epic 8 achieved its primary goal: **comprehensive UX and accessibility infrastructure for the MVP.**

**Positive Outcomes:**
- 103 design tokens establishing theming foundation
- WCAG AA compliance infrastructure (axe-core, LiveAnnouncer, focus traps, skip links, ARIA)
- Dual-layer network security (CSP + Rust validation)
- Zero telemetry verification and documentation
- E2E test scaffolding (page objects, journey specs, API mocking)
- Performance benchmark framework (even if benches are currently stubs)
- 100% story completion for 8th consecutive epic

**Architecture Wins:**
- Design token system with `[data-theme]` switching
- `useFocusTrap`, `useArrowKeyNavigation`, `LiveAnnouncer` hooks
- `VirtualizedList` with paginated Rust queries
- Dual-layer network validation (CSP + `validate_url()`)
- axe-core integration for automated accessibility testing

---

**Retrospective Completed:** 2026-02-11
**Next Priority:** Story 2-7b (Encrypted Database Access Frontend) — RELEASE BLOCKER
**Document:** epic-8-retro-2026-02-11.md
